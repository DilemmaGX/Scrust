import{_ as i,c as t,o as n,ag as e}from"./chunks/framework.KQPf6zax.js";const k=JSON.parse('{"title":"Extensions","description":"","frontmatter":{},"headers":[],"relativePath":"guide/extensions.md","filePath":"guide/extensions.md"}'),a={name:"guide/extensions.md"};function o(l,s,h,r,p,d){return n(),t("div",null,[...s[0]||(s[0]=[e(`<h1 id="extensions" tabindex="-1">Extensions <a class="header-anchor" href="#extensions" aria-label="Permalink to &quot;Extensions&quot;">​</a></h1><div class="warning custom-block"><p class="custom-block-title">EXPERIMENTAL FEATURE</p><p>Extension support in Scrust is currently <strong>highly unstable</strong> and intended for <strong>experimental use only</strong>.</p><p>Only the <strong>Pen</strong> and <strong>Music</strong> extensions have been tested. Use other extensions at your own risk.</p></div><p>Scrust supports Scratch extensions (both official and custom/TurboWarp) via a flexible plugin system. This allows you to use blocks from extensions like Pen, Music, or any community-created extension by defining them in TOML configuration files.</p><h2 id="using-extensions" tabindex="-1">Using Extensions <a class="header-anchor" href="#using-extensions" aria-label="Permalink to &quot;Using Extensions&quot;">​</a></h2><p>To use an extension in your project, you need to:</p><ol><li>Ensure the extension definition file (<code>.toml</code>) exists.</li><li>Add the extension to your <code>scrust.toml</code> configuration file.</li></ol><h3 id="configuration-in-scrust-toml" tabindex="-1">Configuration in scrust.toml <a class="header-anchor" href="#configuration-in-scrust-toml" aria-label="Permalink to &quot;Configuration in scrust.toml&quot;">​</a></h3><p>In your <code>scrust.toml</code>, you can configure extensions in the <code>extensions</code> field under the <code>[project]</code> section. There are two ways to do this:</p><h4 id="_1-simple-list-built-in-extensions" tabindex="-1">1. Simple List (Built-in Extensions) <a class="header-anchor" href="#_1-simple-list-built-in-extensions" aria-label="Permalink to &quot;1. Simple List (Built-in Extensions)&quot;">​</a></h4><p>For extensions that are already known to Scrust (like <code>pen</code> or <code>music</code>) or located in the default <code>extensions/</code> directory, you can simply list their IDs:</p><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;my-project&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">output = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dist/project.sb3&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">extensions = [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;pen&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;music&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><h4 id="_2-detailed-configuration-custom-local-extensions" tabindex="-1">2. Detailed Configuration (Custom/Local Extensions) <a class="header-anchor" href="#_2-detailed-configuration-custom-local-extensions" aria-label="Permalink to &quot;2. Detailed Configuration (Custom/Local Extensions)&quot;">​</a></h4><p>For custom extensions, you can provide a detailed configuration to specify the definition file and the source URL. This is done by adding an inline table to the <code>extensions</code> list.</p><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;my-project&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">output = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dist/project.sb3&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">extensions = [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;pen&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;music&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { name = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Comment Blocks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, id = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;lmscomments&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, source = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://extensions.turbowarp.org/Lily/CommentBlocks.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, definition = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;extensions/lmscomments.toml&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { name = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;RegExp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, id = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;truefantomregexp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, source = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;extensions/regexp.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, definition = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;extensions/truefantomregexp.toml&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><ul><li><strong>name</strong>: The display name of the extension (optional).</li><li><strong>id</strong>: The extension ID (optional, can be inferred from definition).</li><li><strong>source</strong>: The URL where the extension source code is hosted. <ul><li>If this is a <strong>web URL</strong> (http/https), it will be added to the <code>extensionURLs</code> list in the project.</li><li>If this is a <strong>local file path</strong>, the file content will be Base64 encoded and embedded as a <strong>Data URI</strong> in <code>extensionURLs</code>. This allows you to distribute projects with self-contained custom extensions.</li></ul></li><li><strong>definition</strong>: Path to the TOML definition file that maps Scrust functions to opcodes.</li></ul><h2 id="extension-definitions" tabindex="-1">Extension Definitions <a class="header-anchor" href="#extension-definitions" aria-label="Permalink to &quot;Extension Definitions&quot;">​</a></h2><p>Extensions are defined using TOML files. Each file maps Scrust function names to Scratch opcodes.</p><h3 id="file-structure" tabindex="-1">File Structure <a class="header-anchor" href="#file-structure" aria-label="Permalink to &quot;File Structure&quot;">​</a></h3><p>A typical extension definition looks like this:</p><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Extension Name&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">id = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;extensionId&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">blocks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">function_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">opcode = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;extensionId_blockOpcode&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">block_type = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;command&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inputs = { &quot;ARG_NAME&quot; = { arg = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } }</span></span></code></pre></div><ul><li><strong>name</strong>: The display name of the extension.</li><li><strong>id</strong>: The unique ID of the extension.</li><li><strong>blocks</strong>: A table mapping Scrust function names to block definitions.</li></ul><h3 id="block-definition" tabindex="-1">Block Definition <a class="header-anchor" href="#block-definition" aria-label="Permalink to &quot;Block Definition&quot;">​</a></h3><p>Each block definition requires an <code>opcode</code> and optional <code>inputs</code>, <code>fields</code>, or <code>block_type</code>.</p><ul><li><strong>opcode</strong>: The internal opcode used by Scratch/TurboWarp for this block.</li><li><strong>block_type</strong>: The type of the block. Supported values are: <ul><li><code>&quot;command&quot;</code> (default): A stack block that performs an action.</li><li><code>&quot;reporter&quot;</code>: A block that returns a value.</li><li><code>&quot;boolean&quot;</code>: A block that returns a boolean value (true/false).</li><li><code>&quot;hat&quot;</code>: A block that starts a script.</li><li><code>&quot;c_block&quot;</code>: A C Block (like <code>if</code> or <code>repeat</code>) that wraps other blocks.</li></ul></li><li><strong>inputs</strong>: Maps Scratch argument names (e.g., <code>MESSAGE</code>, <code>STEPS</code>) to function arguments. <ul><li><code>{ arg = 0 }</code> maps to the first argument of the Scrust function.</li><li><code>{ arg = 1 }</code> maps to the second argument, and so on.</li></ul></li><li><strong>fields</strong>: Maps dropdown menu fields to specific values.</li></ul><h3 id="using-hat-blocks" tabindex="-1">Using Hat Blocks <a class="header-anchor" href="#using-hat-blocks" aria-label="Permalink to &quot;Using Hat Blocks&quot;">​</a></h3><p>If an extension defines a <code>hat</code> block, you can use it as an attribute on a function. For example, if you have a Hat block named <code>when_received</code> in your extension:</p><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">blocks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">when_received</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">opcode = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;extension_whenReceived&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">block_type = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hat&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inputs = { &quot;MESSAGE&quot; = { arg = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } }</span></span></code></pre></div><p>You can use it in Scrust like this:</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#[when_received(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;message1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> on_message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="built-in-vs-custom-extensions" tabindex="-1">Built-in vs Custom Extensions <a class="header-anchor" href="#built-in-vs-custom-extensions" aria-label="Permalink to &quot;Built-in vs Custom Extensions&quot;">​</a></h2><ul><li><strong>Built-in Extensions</strong>: Extensions like <strong>Pen</strong> and <strong>Music</strong> are included by default.</li><li><strong>Custom Extensions</strong>: You can add support for any TurboWarp extension by creating a new <code>.toml</code> file and configuring it in <code>scrust.toml</code>.</li></ul><h2 id="compatibility-warning" tabindex="-1">Compatibility Warning <a class="header-anchor" href="#compatibility-warning" aria-label="Permalink to &quot;Compatibility Warning&quot;">​</a></h2><p>When building a project that uses extensions other than the official Scratch extensions, Scrust will display a warning:</p><div class="language-plaintext vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">plaintext</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Warning: Project contains extensions not supported by vanilla Scratch. It may only run on TurboWarp or compatible mods.</span></span></code></pre></div><p>This is purely informational and does not prevent the project from building. It serves as a reminder that the generated <code>.sb3</code> file might not load or function correctly in the standard Scratch editor.</p><p><strong>Official Scratch Extensions (No Warning):</strong></p><ul><li><code>pen</code></li><li><code>music</code></li></ul><p>Any extension not in this list, or any extension loaded from a custom URL, will trigger the compatibility warning.</p><h2 id="credits" tabindex="-1">Credits <a class="header-anchor" href="#credits" aria-label="Permalink to &quot;Credits&quot;">​</a></h2><p>Special thanks to the authors of the extensions used in the examples:</p><ul><li><strong>Comment Blocks</strong> by <a href="https://scratch.mit.edu/users/LilyMakesThings/" target="_blank" rel="noreferrer">@LilyMakesThings</a></li><li><strong>RegExp</strong> by <a href="https://scratch.mit.edu/users/TrueFantom/" target="_blank" rel="noreferrer">@TrueFantom</a></li></ul>`,41)])])}const u=i(a,[["render",o]]);export{k as __pageData,u as default};
